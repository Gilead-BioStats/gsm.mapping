meta:
  Type: Mapped
  ID: Baseline
  Description: Baseline Data Mapping
  Priority: 2
spec:
  Raw_NTLSN:
    studyid:
      type: character
    #subjid:
    #  type: character
    subjectid:
      type: character
    scan_dt:
      type: character
  Raw_TLSN:
    studyid:
      type: character
    subjid:
      type: character
    scan_dt:
      type: character
  Mapped_SUBJ:
    subjid:
      type: character
    subjectid:
      type: character
steps:
  - output: Temp_SubjectLookup
    name: dplyr::select
    params:
      .data: Mapped_SUBJ
      subjid: subjid
      subjectid: subjectid

  - output: Temp_NTLSN
    name: dplyr::left_join
    params:
      x: Raw_NTLSN
      "y": Temp_SubjectLookup
      by: subjectid

  - output: Mapped_LSN
    name: dplyr::bind_rows
    params:
      Temp_NTLSN: Temp_NTLSN
      Raw_TLSN: Raw_TLSN
  - output: Mapped_Baseline
    name: gsm.core::RunQuery
    params:
      df: Mapped_LSN
      strQuery: |
        SELECT *
        FROM df
        WHERE subjid IS NOT NULL
          AND scan_dt != ''
