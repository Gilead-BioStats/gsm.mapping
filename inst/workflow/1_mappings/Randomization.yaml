meta:
  Type: Mapped
  ID: Randomization
  Description: Randomization Data Mapping
  Priority: 1
spec:
  Raw_Randomization:
    studyid:
      type: character
    invid:
      type: character
    subjid:
      type: character
    rgmn_dt:
      type: character
    status:
      type: character
    country:
      type: character
steps:
  - output: Mapped_Randomization
    name: gsm.core::RunQuery
    params:
      df: Raw_Randomization
      strQuery: |
        SELECT *
        FROM df
        WHERE subjid IS NOT NULL
          AND (status != 'Screen Failed' OR status IS NULL)
          AND rgmn_dt != ''
