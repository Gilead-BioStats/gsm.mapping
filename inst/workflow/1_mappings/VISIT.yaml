meta:
  Type: Mapped
  ID: VISIT
  Description: Visit Data Mapping
  Priority: 1
spec:
  Raw_VISIT:
    studyid:
      type: character
    subjid:
      type: character
    visit:
      type: character
      source_col: foldername
    visit_dt:
      type: character
steps:
  - output: Mapped_VISIT
    name: gsm.core::RunQuery
    params:
      df: Raw_VISIT
      strQuery: |
        SELECT *
        FROM df
        WHERE visit_dt != ''
          AND (try_cast(visit_dt as date) is not null)
